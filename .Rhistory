plot.results <- function(data, num.exp, y.min=0, y.max=3000){
pos <- data$dbR[,1]
y.ave <- apply(data$dbR[,2:(num.exp+1)], 1, median)
plot(pos, y.ave, type='h', col=ifelse(pos%in%data$peak, "red", "grey"), axes=F, xlab="chromosomal position", ylab="4C signal", ylim=c(y.min,y.max) )
axis(2, at=c(0,y.max), las=2)
at <- seq(200e3*floor(min(pos)/200e3), ceiling(max(pos)/200e3)*200e3, by=200e3)
axis(1, at=seq(0,1e9,by=200e3), lab=sprintf("%.1f", seq(0,1e9,by=200e3)/1e6), cex.axis=1.5)
}
pplot.results()
plot.results()
library(peakC)
readMultiple(files=c(""))
files <- dir("/data/4C/high_res_methods/new_analysis/reciprocal/", full=T)
files
read.delim(files[1], h=F)->a
plot(a,type='h')
a[which.max(a[,2])]
a[which.max(a[,2]),1]
vp.pos <- a[which.max(a[,2]),1]
d <- readMultiple(files, vp.pos = vp.pos, window=1e6)
str(d)
plot(d[[1]], type='h')
plot(d[[2]], type='h')
plot(d[[3]], type='h')
plot(d[[1]], type='h')
res <- combined.analysis(data=d, num.exp=3, vp.pos=vp.pos)
plot.results(res, num.exp=3)
?plot.results
roxygen2::roxygenise()
library(peakC)
?plot.results
library(peakC)
roxygen2::roxygenise()
library(peakC)
?plot.C.data
plot.C.data(res, num.exp=3)
?plot.C.data
plot.C.data
roxygen2::roxygenise()
library(peakC)
plot_C(res, num.exp=3)
dir("/data/4C/high_res_methods/new_analysis/reciprocal/")
dir("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/")
dir("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", pattern="rep")
dir("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", pattern="rep", recursive = T)
dir("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", pattern="rep", recursive = F)
dir("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", pattern="rep", include.dirs = T, recursive = T)
list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos1")
list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos1")
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos1")
p <- readMultiple(f[1:3], vp.pos = 65923803)
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos1", full.names = T)
f
p <- readMultiple(f[1:3], vp.pos = 65923803)
str(p)
plot(p[[1]], type='h')
scan("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/vp_pos.txt")
vp <- scan("/data/4C/high_res_methods/new_analysis/reciprocal/peakC/vp_pos.txt")
p <- readMultiple(f[1:3], vp.pos = vp[1])
r <- combined.analysis(p, 3, vp[1])
roxygen2::roxygenise()
library(peakC)
r <- combined.analysis(p, 3, vp[1])
plot_C(r)
plot_C(r, num.exp=3)
p <- readMultiple(f[4:6], vp.pos = vp[1])
r <- combined.analysis(p, 3, vp[1])
plot_C(r, num.exp=3)
?combined.analysis
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos2", full.names = T)
p <- readMultiple(f[4:6], vp.pos = vp[1])
r <- combined.analysis(p, 3, vp[1])
r <- combined.analysis(p, 3, vp[2])
plot_C(r, num.exp=3)
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos3", full.names = T)
r <- combined.analysis(p, 3, vp[3])
plot_C(r, num.exp=3)
p <- readMultiple(f[1:6], vp.pos = vp[1])
r <- combined.analysis(p, 6, vp[3])
plot_C(r, num.exp=3)
plot_C(r, num.exp=3)
plot_C(r, num.exp=6)
f
readMultiple()
readMultiple
p <- readMultiple(f[1:3], vp.pos = vp[1])
r <- combined.analysis(p, 3, vp[3])
plot_C(r, num.exp=6)
p <- readMultiple(f[4:6], vp.pos = vp[1])
r <- combined.analysis(p, 3, vp[3])
plot_C(r, num.exp=6)
p <- readMultiple(f[4:6], vp.pos = vp[3])
r <- combined.analysis(p, 3, vp[3])
plot_C(r, num.exp=6)
p <- readMultiple(f[1:6], vp.pos = vp[3])
r <- combined.analysis(p, 6, vp[3])
plot_C(r, num.exp=6)
par(mfrow=c(3,1))
library(peakC)
plot_C(r, num.exp=6, xlim=c(64e6,67e6))
par(mfrow=c(3,1))
plot_C(r, num.exp=6, xlim=c(64e6,67e6))
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos2", full.names = T)
p <- readMultiple(f[1:6], vp.pos = vp[2])
r <- combined.analysis(p, 6, vp[2])
plot_C(r, num.exp=6, xlim=c(64e6,67e6))
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern="pos1", full.names = T)
p <- readMultiple(f[1:6], vp.pos = vp[1])
r <- combined.analysis(p, 6, vp[1])
plot_C(r, num.exp=6, xlim=c(64e6,67e6))
for(i in c(3,1,2)){
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern=paste0("pos",i), full.names = T)
p <- readMultiple(f[1:6], vp.pos = vp[i], window = 1.5e6)
r <- combined.analysis(p, 6, vp[i])
plot_C(r, num.exp=6, xlim=c(64e6,67e6))
}
for(i in c(3,1,2)){
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern=paste0("pos",i), full.names = T)
p <- readMultiple(f[1:3], vp.pos = vp[i], window = 1.5e6)
r <- combined.analysis(p, 6, vp[i])
plot_C(r, num.exp=6, xlim=c(64e6,67e6))
}
for(i in c(3,1,2)){
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern=paste0("pos",i), full.names = T)
p <- readMultiple(f[1:3], vp.pos = vp[i], window = 1.5e6)
r <- combined.analysis(p, 3, vp[i])
plot_C(r, num.exp=3, xlim=c(64e6,67e6))
}
str(p
str(p
str(p)
p$num.exp = 3
str(p)
length(p)
p <- readMultiple(f[1:3], vp.pos = vp[i], window = 1.5e6)
length(p)
roxygen2::roxygenise()
library(peakC)
for(i in c(3,1,2)){
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern=paste0("pos",i), full.names = T)
p <- readMultiple(f[1:3], vp.pos = vp[i], window = 1.5e6)
r <- combined.analysis(p,  vp.pos=vp[i])
plot_C(r, xlim=c(64e6,67e6))
}
for(i in c(3,1,2)){
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern=paste0("pos",i), full.names = T)
p <- readMultiple(f[1:4], vp.pos = vp[i], window = 1.5e6)
r <- combined.analysis(p,  vp.pos=vp[i])
plot_C(r, xlim=c(64e6,67e6))
}
for(i in c(3,1,2)){
f <- list.files(path = "/data/4C/high_res_methods/new_analysis/reciprocal/peakC/", recursive = T, pattern=paste0("pos",i), full.names = T)
p <- readMultiple(f[1], vp.pos = vp[i], window = 1.5e6)
r <- combined.analysis(p,  vp.pos=vp[i])
plot_C(r, xlim=c(64e6,67e6))
}
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
ls()
roxygen2::roxygenise()
library(peakC)
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
library(peakC)
roxygen2::roxygenise()
